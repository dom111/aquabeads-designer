(()=>{var nt=(i,e,t)=>{if(!e.has(i))throw TypeError("Cannot "+t)};var a=(i,e,t)=>(nt(i,e,"read from private field"),t?t.call(i):e.get(i)),d=(i,e,t)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,t)},f=(i,e,t,n)=>(nt(i,e,"write to private field"),n?n.call(i,t):e.set(i,t),t);var it=(i,e,t)=>new Promise((n,o)=>{var r=v=>{try{m(t.next(v))}catch(b){o(b)}},g=v=>{try{m(t.throw(v))}catch(b){o(b)}},m=v=>v.done?n(v.value):Promise.resolve(v.value).then(r,g);m((t=t.apply(i,e)).next())});var p;(function(i){i.Attribute="attribute",i.Pseudo="pseudo",i.PseudoElement="pseudo-element",i.Tag="tag",i.Universal="universal",i.Adjacent="adjacent",i.Child="child",i.Descendant="descendant",i.Parent="parent",i.Sibling="sibling",i.ColumnCombinator="column-combinator"})(p||(p={}));var c;(function(i){i.Any="any",i.Element="element",i.End="end",i.Equals="equals",i.Exists="exists",i.Hyphen="hyphen",i.Not="not",i.Start="start"})(c||(c={}));var at=/^[^\\#]?(?:\\(?:[\da-f]{1,6}\s?|.)|[\w\-\u00b0-\uFFFF])+/,ct=/\\([\da-f]{1,6}\s?|(\s)|.)/gi,Et=new Map([[126,c.Element],[94,c.Start],[36,c.End],[42,c.Any],[33,c.Not],[124,c.Hyphen]]),vt=new Set(["has","not","matches","is","where","host","host-context"]);function ot(i){switch(i.type){case p.Adjacent:case p.Child:case p.Descendant:case p.Parent:case p.Sibling:case p.ColumnCombinator:return!0;default:return!1}}var bt=new Set(["contains","icontains"]);function gt(i,e,t){let n=parseInt(e,16)-65536;return n!==n||t?e:n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,n&1023|56320)}function N(i){return i.replace(ct,gt)}function R(i){return i===39||i===34}function rt(i){return i===32||i===9||i===10||i===12||i===13}function U(i){let e=[],t=st(e,`${i}`,0);if(t<i.length)throw new Error(`Unmatched selector: ${i.slice(t)}`);return e}function st(i,e,t){let n=[];function o(u){let s=e.slice(t+u).match(at);if(!s)throw new Error(`Expected name, found ${e.slice(t)}`);let[h]=s;return t+=u+h.length,N(h)}function r(u){for(t+=u;t<e.length&&rt(e.charCodeAt(t));)t++}function g(){t+=1;let u=t,s=1;for(;s>0&&t<e.length;t++)e.charCodeAt(t)===40&&!m(t)?s++:e.charCodeAt(t)===41&&!m(t)&&s--;if(s)throw new Error("Parenthesis not matched");return N(e.slice(u,t-1))}function m(u){let s=0;for(;e.charCodeAt(--u)===92;)s++;return(s&1)===1}function v(){if(n.length>0&&ot(n[n.length-1]))throw new Error("Did not expect successive traversals.")}function b(u){if(n.length>0&&n[n.length-1].type===p.Descendant){n[n.length-1].type=u;return}v(),n.push({type:u})}function Z(u,s){n.push({type:p.Attribute,name:u,action:s,value:o(1),namespace:null,ignoreCase:"quirks"})}function I(){if(n.length&&n[n.length-1].type===p.Descendant&&n.pop(),n.length===0)throw new Error("Empty sub-selector");i.push(n)}if(r(0),e.length===t)return t;t:for(;t<e.length;){let u=e.charCodeAt(t);switch(u){case 32:case 9:case 10:case 12:case 13:{(n.length===0||n[0].type!==p.Descendant)&&(v(),n.push({type:p.Descendant})),r(1);break}case 62:{b(p.Child),r(1);break}case 60:{b(p.Parent),r(1);break}case 126:{b(p.Sibling),r(1);break}case 43:{b(p.Adjacent),r(1);break}case 46:{Z("class",c.Element);break}case 35:{Z("id",c.Equals);break}case 91:{r(1);let s,h=null;e.charCodeAt(t)===124?s=o(1):e.startsWith("*|",t)?(h="*",s=o(2)):(s=o(0),e.charCodeAt(t)===124&&e.charCodeAt(t+1)!==61&&(h=s,s=o(1))),r(0);let C=c.Exists,tt=Et.get(e.charCodeAt(t));if(tt){if(C=tt,e.charCodeAt(t+1)!==61)throw new Error("Expected `=`");r(2)}else e.charCodeAt(t)===61&&(C=c.Equals,r(1));let F="",$=null;if(C!=="exists"){if(R(e.charCodeAt(t))){let j=e.charCodeAt(t),k=t+1;for(;k<e.length&&(e.charCodeAt(k)!==j||m(k));)k+=1;if(e.charCodeAt(k)!==j)throw new Error("Attribute value didn't end");F=N(e.slice(t+1,k)),t=k+1}else{let j=t;for(;t<e.length&&(!rt(e.charCodeAt(t))&&e.charCodeAt(t)!==93||m(t));)t+=1;F=N(e.slice(j,t))}r(0);let et=e.charCodeAt(t)|32;et===115?($=!1,r(1)):et===105&&($=!0,r(1))}if(e.charCodeAt(t)!==93)throw new Error("Attribute selector didn't terminate");t+=1;let mt={type:p.Attribute,name:s,action:C,value:F,namespace:h,ignoreCase:$};n.push(mt);break}case 58:{if(e.charCodeAt(t+1)===58){n.push({type:p.PseudoElement,name:o(2).toLowerCase(),data:e.charCodeAt(t)===40?g():null});continue}let s=o(1).toLowerCase(),h=null;if(e.charCodeAt(t)===40)if(vt.has(s)){if(R(e.charCodeAt(t+1)))throw new Error(`Pseudo-selector ${s} cannot be quoted`);if(h=[],t=st(h,e,t+1),e.charCodeAt(t)!==41)throw new Error(`Missing closing parenthesis in :${s} (${e})`);t+=1}else{if(h=g(),bt.has(s)){let C=h.charCodeAt(0);C===h.charCodeAt(h.length-1)&&R(C)&&(h=h.slice(1,-1))}h=N(h)}n.push({type:p.Pseudo,name:s,data:h});break}case 44:{I(),n=[],r(1);break}default:{if(e.startsWith("/*",t)){let C=e.indexOf("*/",t+2);if(C<0)throw new Error("Comment was not terminated");t=C+2,n.length===0&&r(0);break}let s=null,h;if(u===42)t+=1,h="*";else if(u===124){if(h="",e.charCodeAt(t+1)===124){b(p.ColumnCombinator),r(2);break}}else if(at.test(e.slice(t)))h=o(0);else break t;e.charCodeAt(t)===124&&e.charCodeAt(t+1)!==124&&(s=h,e.charCodeAt(t+1)===42?(h="*",t+=2):h=o(1)),n.push(h==="*"?{type:p.Universal,namespace:s}:{type:p.Tag,name:h,namespace:s})}}}return I(),t}var _=i=>{for(;i.hasChildNodes();)i.firstChild.remove()},G=(i,e,t,n)=>i.addEventListener(e,t,n),L=(i,e,t,n)=>{e.forEach(o=>G(i,o,t,n))},E=(i,...e)=>{let[t]=U(i).map(n=>n.reduce((o,r)=>{var g;return o===null&&r.type!=="tag"&&(o=document.createElement("div")),r.type==="tag"?document.createElement(r.name):(r.type==="attribute"&&r.name!=="class"&&o.setAttribute(r.name,(g=r.value)!=null?g:""),r.type==="attribute"&&r.name==="class"&&o.classList.add(r.value),o)},null));return e.forEach(n=>t.append(n)),t},q=i=>document.createTextNode(i),K,W=class{constructor(e,...t){d(this,K,void 0);f(this,K,E(e,...t))}on(e,t,n){G(this.element(),e,t,n)}onEach(e,t,n){L(this.element(),e,t,n)}append(...e){return this.element().append(...e)}element(){return a(this,K)}empty(){_(this.element())}};K=new WeakMap;var w=W;var Q=class extends w{constructor(e,t){super("section.actions");let n=E('button.clear[title="Clear"]',q("\u267B"));L(n,["mousedown","touchstart"],()=>{e.clear(),window.location.hash=""});let o=E('button.link[title="Generate link"]',q("\u{1F517}"));L(o,["mousedown","touchstart"],()=>window.location.hash="#"+t.toString()),this.append(n,o)}},ht=Q;var M,D,O,T,P,x=class extends w{constructor(t,n,o,r){super(".cell");d(this,M,"transparent");d(this,D,void 0);d(this,O,void 0);d(this,T,void 0);d(this,P,void 0);f(this,D,o),f(this,O,r),f(this,T,t),f(this,P,n),this.bindEvents(),this.paint(r.getEntry(t,n))}bindEvents(){this.on("paint",()=>this.paint())}clear(){this.paint("transparent")}paint(t){typeof t=="undefined"&&(t=a(this,D).currentColour()),f(this,M,t),this.element().style.backgroundColor=a(this,M),a(this,O).getEntry(a(this,T),a(this,P))!==t&&a(this,O).setEntry(a(this,T),a(this,P),a(this,M))}};M=new WeakMap,D=new WeakMap,O=new WeakMap,T=new WeakMap,P=new WeakMap;var pt=x;var H,J=class extends w{constructor(t,n){super("section.board");d(this,H,void 0);let{height:o,width:r}=n.board();f(this,H,this.generateCells(o,r,t,n)),a(this,H).forEach(g=>this.append(E(".row",...g.map(m=>m.element())))),this.bindEvents()}bindEvents(){this.onEach(["mousedown","mousemove","touchstart","touchmove"],t=>{if(!(t instanceof MouseEvent&&(t.buttons&1)===0)){if(t instanceof TouchEvent){t.preventDefault(),[...t.touches].forEach(n=>{let o=document.elementFromPoint(n.pageX,n.pageY);!o.matches(".cell")||o.dispatchEvent(new CustomEvent("paint"))});return}t.target.dispatchEvent(new CustomEvent("paint"))}})}clear(){a(this,H).flat().forEach(t=>t.clear())}generateCells(t,n,o,r){return new Array(t).fill(0).map((g,m)=>new Array(n-m%2).fill(0).map((v,b)=>new pt(b,m,o,r)))}};H=new WeakMap;var ut=J;var z=class extends w{constructor(){super("p.footer",E("small",q("This site is not affiliated with Aquabeads\xAE or EPOCH. Aquabeads\xAE is a registered trademark of EPOCH.")))}},ft=z;var Ct=16,y,S,A,V=class extends w{constructor(t){super("section.picker");d(this,y,void 0);d(this,S,void 0);d(this,A,void 0);f(this,A,t.palette()),f(this,y,E('input[type="color"]')),a(this,y).value=a(this,A)[0],f(this,S,E("section.recent")),this.append(a(this,y),a(this,S)),this.bindEvents(),this.updateRecent()}bindEvents(){G(a(this,y),"input",()=>{let t=a(this,y).value,n=a(this,A).indexOf(t);n>-1&&a(this,A).splice(n,1),a(this,A).unshift(t),a(this,A).splice(Ct),this.updateRecent()})}currentColour(){return a(this,y).value}updateRecent(){_(a(this,S)),a(this,S).append(...a(this,A).map(t=>{let n=E("button");return n.style.backgroundColor=t,L(n,["mousedown","touchstart"],()=>a(this,y).value=t),n}))}};y=new WeakMap,S=new WeakMap,A=new WeakMap;var dt=V;var wt={board:{height:26,width:22},entries:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],lookup:["transparent"],palette:["#ff0000","#ff8800","#ffff88","#ffff00","#88ff00","#00ff88","#88ffff","#00ffff","#0088ff","#8800ff","#ff00ff","#ff0088","#ff88ff","#000000","#888888","#ffffff"]},l,Y=class{constructor(){d(this,l,void 0)}board(){return a(this,l).board}coordsToIndex(e,t){let{width:n}=this.board();return n*t-Math.ceil(t/2)+e}static fromString(e){try{let t=atob(e);return JSON.parse(t)}catch(t){return console.error(t),null}}init(e){return it(this,null,function*(){f(this,l,Y.fromString(e.hash.slice(1))),a(this,l)===null&&f(this,l,wt)})}getEntry(e,t){return a(this,l).lookup[a(this,l).entries[this.coordsToIndex(e,t)]]}palette(){return a(this,l).palette}setEntry(e,t,n){a(this,l).lookup.includes(n)||a(this,l).lookup.push(n),a(this,l).entries[this.coordsToIndex(e,t)]=a(this,l).lookup.indexOf(n)}toString(){return btoa(JSON.stringify(a(this,l)))}},X=Y;l=new WeakMap;var lt=X;var B=new lt;B.init(window.location).then(()=>{let i=new dt(B),e=new ut(i,B),t=new ht(e,B),n=new ft;document.getElementById("app").append(t.element(),e.element(),i.element(),n.element())});})();
//# sourceMappingURL=app.js.map
