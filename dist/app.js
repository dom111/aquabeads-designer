(()=>{var G=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)};var h=(n,e,t)=>(G(n,e,"read from private field"),t?t.call(n):e.get(n)),p=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)},m=(n,e,t,i)=>(G(n,e,"write to private field"),i?i.call(n,t):e.set(n,t),t);var u;(function(n){n.Attribute="attribute",n.Pseudo="pseudo",n.PseudoElement="pseudo-element",n.Tag="tag",n.Universal="universal",n.Adjacent="adjacent",n.Child="child",n.Descendant="descendant",n.Parent="parent",n.Sibling="sibling",n.ColumnCombinator="column-combinator"})(u||(u={}));var d;(function(n){n.Any="any",n.Element="element",n.End="end",n.Equals="equals",n.Exists="exists",n.Hyphen="hyphen",n.Not="not",n.Start="start"})(d||(d={}));var J=/^[^\\#]?(?:\\(?:[\da-f]{1,6}\s?|.)|[\w\-\u00b0-\uFFFF])+/,ot=/\\([\da-f]{1,6}\s?|(\s)|.)/gi,ut=new Map([[126,d.Element],[94,d.Start],[36,d.End],[42,d.Any],[33,d.Not],[124,d.Hyphen]]),ht=new Set(["has","not","matches","is","where","host","host-context"]);function Z(n){switch(n.type){case u.Adjacent:case u.Child:case u.Descendant:case u.Parent:case u.Sibling:case u.ColumnCombinator:return!0;default:return!1}}var ft=new Set(["contains","icontains"]);function pt(n,e,t){let i=parseInt(e,16)-65536;return i!==i||t?e:i<0?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,i&1023|56320)}function L(n){return n.replace(ot,pt)}function U(n){return n===39||n===34}function K(n){return n===32||n===9||n===10||n===12||n===13}function W(n){let e=[],t=x(e,`${n}`,0);if(t<n.length)throw new Error(`Unmatched selector: ${n.slice(t)}`);return e}function x(n,e,t){let i=[];function o(f){let r=e.slice(t+f).match(J);if(!r)throw new Error(`Expected name, found ${e.slice(t)}`);let[s]=r;return t+=f+s.length,L(s)}function a(f){for(t+=f;t<e.length&&K(e.charCodeAt(t));)t++}function c(){t+=1;let f=t,r=1;for(;r>0&&t<e.length;t++)e.charCodeAt(t)===40&&!k(t)?r++:e.charCodeAt(t)===41&&!k(t)&&r--;if(r)throw new Error("Parenthesis not matched");return L(e.slice(f,t-1))}function k(f){let r=0;for(;e.charCodeAt(--f)===92;)r++;return(r&1)===1}function q(){if(i.length>0&&Z(i[i.length-1]))throw new Error("Did not expect successive traversals.")}function y(f){if(i.length>0&&i[i.length-1].type===u.Descendant){i[i.length-1].type=f;return}q(),i.push({type:f})}function z(f,r){i.push({type:u.Attribute,name:f,action:r,value:o(1),namespace:null,ignoreCase:"quirks"})}function V(){if(i.length&&i[i.length-1].type===u.Descendant&&i.pop(),i.length===0)throw new Error("Empty sub-selector");n.push(i)}if(a(0),e.length===t)return t;t:for(;t<e.length;){let f=e.charCodeAt(t);switch(f){case 32:case 9:case 10:case 12:case 13:{(i.length===0||i[0].type!==u.Descendant)&&(q(),i.push({type:u.Descendant})),a(1);break}case 62:{y(u.Child),a(1);break}case 60:{y(u.Parent),a(1);break}case 126:{y(u.Sibling),a(1);break}case 43:{y(u.Adjacent),a(1);break}case 46:{z("class",d.Element);break}case 35:{z("id",d.Equals);break}case 91:{a(1);let r,s=null;e.charCodeAt(t)===124?r=o(1):e.startsWith("*|",t)?(s="*",r=o(2)):(r=o(0),e.charCodeAt(t)===124&&e.charCodeAt(t+1)!==61&&(s=r,r=o(1))),a(0);let l=d.Exists,X=ut.get(e.charCodeAt(t));if(X){if(l=X,e.charCodeAt(t+1)!==61)throw new Error("Expected `=`");a(2)}else e.charCodeAt(t)===61&&(l=d.Equals,a(1));let F="",$=null;if(l!=="exists"){if(U(e.charCodeAt(t))){let S=e.charCodeAt(t),g=t+1;for(;g<e.length&&(e.charCodeAt(g)!==S||k(g));)g+=1;if(e.charCodeAt(g)!==S)throw new Error("Attribute value didn't end");F=L(e.slice(t+1,g)),t=g+1}else{let S=t;for(;t<e.length&&(!K(e.charCodeAt(t))&&e.charCodeAt(t)!==93||k(t));)t+=1;F=L(e.slice(S,t))}a(0);let Y=e.charCodeAt(t)|32;Y===115?($=!1,a(1)):Y===105&&($=!0,a(1))}if(e.charCodeAt(t)!==93)throw new Error("Attribute selector didn't terminate");t+=1;let st={type:u.Attribute,name:r,action:l,value:F,namespace:s,ignoreCase:$};i.push(st);break}case 58:{if(e.charCodeAt(t+1)===58){i.push({type:u.PseudoElement,name:o(2).toLowerCase(),data:e.charCodeAt(t)===40?c():null});continue}let r=o(1).toLowerCase(),s=null;if(e.charCodeAt(t)===40)if(ht.has(r)){if(U(e.charCodeAt(t+1)))throw new Error(`Pseudo-selector ${r} cannot be quoted`);if(s=[],t=x(s,e,t+1),e.charCodeAt(t)!==41)throw new Error(`Missing closing parenthesis in :${r} (${e})`);t+=1}else{if(s=c(),ft.has(r)){let l=s.charCodeAt(0);l===s.charCodeAt(s.length-1)&&U(l)&&(s=s.slice(1,-1))}s=L(s)}i.push({type:u.Pseudo,name:r,data:s});break}case 44:{V(),i=[],a(1);break}default:{if(e.startsWith("/*",t)){let l=e.indexOf("*/",t+2);if(l<0)throw new Error("Comment was not terminated");t=l+2,i.length===0&&a(0);break}let r=null,s;if(f===42)t+=1,s="*";else if(f===124){if(s="",e.charCodeAt(t+1)===124){y(u.ColumnCombinator),a(2);break}}else if(J.test(e.slice(t)))s=o(0);else break t;e.charCodeAt(t)===124&&e.charCodeAt(t+1)!==124&&(r=s,e.charCodeAt(t+1)===42?(s="*",t+=2):s=o(1)),i.push(s==="*"?{type:u.Universal,namespace:r}:{type:u.Tag,name:s,namespace:r})}}}return V(),t}var B=n=>{for(;n.hasChildNodes();)n.firstChild.remove()},M=(n,e,t,i)=>{e.forEach(o=>n.addEventListener(o,t,i))},E=(n,...e)=>{let[t]=W(n).map(i=>i.reduce((o,a)=>{var c;if(o===null&&a.type!=="tag")throw new Error("Unexpected.");return a.type==="tag"?document.createElement(a.name):(a.type==="attribute"&&a.name!=="class"&&o.setAttribute(a.name,(c=a.value)!=null?c:""),a.type==="attribute"&&a.name==="class"&&o.classList.add(a.value),o)},null));return e.forEach(i=>t.append(i)),t},I=n=>document.createTextNode(n),P,j=class{constructor(e,...t){p(this,P,void 0);m(this,P,E(e,...t))}addEventListener(e,t,i){this.element().addEventListener(e,t,i)}addEventListeners(e,t,i){M(this.element(),e,t,i)}append(...e){return this.element().append(...e)}element(){return h(this,P)}empty(){B(this.element())}};P=new WeakMap;var C=j;var H,T,D,N,O=class extends C{constructor(t,i,o){super("div.cell");p(this,H,"transparent");p(this,T,void 0);p(this,D,void 0);p(this,N,void 0);m(this,T,o),m(this,D,t),m(this,N,i),this.bindEvents()}bindEvents(){this.addEventListener("paint",()=>this.paint())}clear(){this.paint("transparent")}paint(t){typeof t=="undefined"&&(t=h(this,T).currentColour()),m(this,H,t),this.element().style.backgroundColor=h(this,H)}x(){return h(this,D)}y(){return h(this,N)}};H=new WeakMap,T=new WeakMap,D=new WeakMap,N=new WeakMap;var tt=O;var A,Q=class extends C{constructor(t,i=26,o=22){super("section.board");p(this,A,void 0);m(this,A,this.generateCells(i,o,t)),h(this,A).forEach(a=>this.append(E("div.row",...a.map(c=>c.element())))),this.bindEvents()}bindEvents(){["mousedown","mousemove","touchstart","touchmove"].forEach(t=>this.addEventListener(t,i=>{if(!(i instanceof MouseEvent&&(i.buttons&1)===0)){if(i instanceof TouchEvent){i.preventDefault(),[...i.touches].forEach(o=>{let a=document.elementFromPoint(o.pageX,o.pageY);!a.matches(".cell")||a===this.element()||a.dispatchEvent(new CustomEvent("paint"))});return}i.target.dispatchEvent(new CustomEvent("paint"))}}))}clear(){h(this,A).flat().forEach(t=>t.clear())}generateCells(t,i,o){return new Array(t).fill(0).map((a,c)=>new Array(i-c%2).fill(0).map((k,q)=>new tt(q,c,o)))}};A=new WeakMap;var et=Q;var v,b,w,R=class extends C{constructor(){super("section.picker");p(this,v,void 0);p(this,b,void 0);p(this,w,["#ffffff","#888888","#000000","#ff0000","#ff8800","#ffff88","#ffff00","#88ff00","#00ff88","#88ffff","#00ffff","#0088ff","#8800ff","#ff00ff","#ff0088","#ff88ff"]);m(this,v,E('input[type="color"][value="#000000"]')),m(this,b,E("section.recent")),this.append(h(this,v),h(this,b)),this.bindEvents(),this.updateRecent()}bindEvents(){h(this,v).addEventListener("input",()=>{let t=h(this,v).value;m(this,w,h(this,w).filter(i=>i!==t).slice(0,15)),h(this,w).unshift(t),this.updateRecent()})}currentColour(){return h(this,v).value}updateRecent(){B(h(this,b)),h(this,b).append(...h(this,w).map(t=>{let i=E("button");return i.style.backgroundColor=t,M(i,["mousedown","touchstart"],()=>h(this,v).value=t),i}))}};v=new WeakMap,b=new WeakMap,w=new WeakMap;var nt=R;var _=class extends C{constructor(e){super("section.actions");let t=E("button.clear",I("\u267B"));M(t,["mousedown","touchstart"],()=>e.clear()),this.append(t)}},it=_;var at=new nt,rt=new et(at),mt=new it(rt),dt=document.getElementById("app");dt.append(mt.element(),rt.element(),at.element());})();
//# sourceMappingURL=app.js.map
